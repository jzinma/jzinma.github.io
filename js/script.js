angular.module("PeanutButter",["react","ngRoute","pbroutes","pb.services","pb.faceController","pb.tagController","pb.searchController","pb.snippetController"]);
angular.module("pbroutes",[]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"partial/home/home-view.html",controller:"faceController"}).when("/tag",{templateUrl:"partial/tag/tag-input-view.html",controller:"tagController"}).when("/search",{templateUrl:"partial/search/search-view.html",controller:"searchController"}).when("/snippet",{templateUrl:"partial/snippet/snippet-view.html",controller:"snippetController as ctrl"}).when("/contact",{templateUrl:"partial/home/contact-view.html"}).otherwise({redirectTo:"/"})}]);
!function(s){"use strict";function e(s){return new RegExp("(^|\\s+)"+s+"(\\s+|$)")}function n(s,e){var n=t(s,e)?c:a;n(s,e)}var t,a,c;"classList"in document.documentElement?(t=function(s,e){return s.classList.contains(e)},a=function(s,e){s.classList.add(e)},c=function(s,e){s.classList.remove(e)}):(t=function(s,n){return e(n).test(s.className)},a=function(s,e){t(s,e)||(s.className=s.className+" "+e)},c=function(s,n){s.className=s.className.replace(e(n)," ")});var o={hasClass:t,addClass:a,removeClass:c,toggleClass:n,has:t,add:a,remove:c,toggle:n};"function"==typeof define&&define.amd?define(o):"object"==typeof exports?module.exports=o:s.classie=o}(window);
!function(){function e(){var e=document.querySelector(".container"),n=document.getElementById("menu-btn");n.addEventListener("click",function(n){n.stopPropagation(),n.preventDefault(),classie.add(e,"menu-open"),document.addEventListener("touchstart",t)})}var n=function(e,n){for(;"HTML"!=e.nodeName;){if(e.parentElement.id==n)return!0;e=e.parentElement}},t=function(e){if(console.log(e),!n(e.target,"side")){var o=document.querySelector(".container");classie.remove(o,"menu-open"),document.removeEventListener("touchstart",t)}};e()}();
!function(e){e.fn.extend({leanModal:function(n){function o(n){e("#lean_overlay").fadeOut(200),e(n).css({display:"none"})}var t={top:100,overlay:.5,closeButton:null},a=e("<div id='lean_overlay'></div>");return e("body").append(a),n=e.extend(t,n),this.each(function(){var t=n;e(this).click(function(n){var a=e(this).attr("href");e("#lean_overlay").click(function(){o(a)}),e(t.closeButton).click(function(){o(a)});var l=(e(a).outerHeight(),e(a).outerWidth());e("#lean_overlay").css({display:"block",opacity:0}),e("#lean_overlay").fadeTo(200,t.overlay),e(a).css({display:"block",position:"fixed",opacity:0,"z-index":11e3,left:"50%","margin-left":-(l/2)+"px",top:t.top+"px"}),e(a).fadeTo(200,1),n.preventDefault()})})}})}(jQuery);
(function(){var t=this,e=t._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,a=r.push,o=r.slice,c=r.concat,l=i.toString,h=i.hasOwnProperty,u=r.forEach,f=r.map,d=r.reduce,p=r.reduceRight,g=r.filter,m=r.every,_=r.some,v=r.indexOf,y=r.lastIndexOf,x=Array.isArray,b=Object.keys,w=s.bind,A=function(t){return t instanceof A?t:this instanceof A?void(this._wrapped=t):new A(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=A),exports._=A):t._=A,A.VERSION="1.5.1";var E=A.each=A.forEach=function(t,e,r){if(null!=t)if(u&&t.forEach===u)t.forEach(e,r);else if(t.length===+t.length){for(var i=0,s=t.length;s>i;i++)if(e.call(r,t[i],i,t)===n)return}else for(var a in t)if(A.has(t,a)&&e.call(r,t[a],a,t)===n)return};A.map=A.collect=function(t,e,n){var r=[];return null==t?r:f&&t.map===f?t.map(e,n):(E(t,function(t,i,s){r.push(e.call(n,t,i,s))}),r)};var C="Reduce of empty array with no initial value";A.reduce=A.foldl=A.inject=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return r&&(e=A.bind(e,r)),i?t.reduce(e,n):t.reduce(e);if(E(t,function(t,s,a){i?n=e.call(r,n,t,s,a):(n=t,i=!0)}),!i)throw new TypeError(C);return n},A.reduceRight=A.foldr=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return r&&(e=A.bind(e,r)),i?t.reduceRight(e,n):t.reduceRight(e);var s=t.length;if(s!==+s){var a=A.keys(t);s=a.length}if(E(t,function(o,c,l){c=a?a[--s]:--s,i?n=e.call(r,n,t[c],c,l):(n=t[c],i=!0)}),!i)throw new TypeError(C);return n},A.find=A.detect=function(t,e,n){var r;return k(t,function(t,i,s){return e.call(n,t,i,s)?(r=t,!0):void 0}),r},A.filter=A.select=function(t,e,n){var r=[];return null==t?r:g&&t.filter===g?t.filter(e,n):(E(t,function(t,i,s){e.call(n,t,i,s)&&r.push(t)}),r)},A.reject=function(t,e,n){return A.filter(t,function(t,r,i){return!e.call(n,t,r,i)},n)},A.every=A.all=function(t,e,r){e||(e=A.identity);var i=!0;return null==t?i:m&&t.every===m?t.every(e,r):(E(t,function(t,s,a){return(i=i&&e.call(r,t,s,a))?void 0:n}),!!i)};var k=A.some=A.any=function(t,e,r){e||(e=A.identity);var i=!1;return null==t?i:_&&t.some===_?t.some(e,r):(E(t,function(t,s,a){return i||(i=e.call(r,t,s,a))?n:void 0}),!!i)};A.contains=A.include=function(t,e){return null==t?!1:v&&t.indexOf===v?-1!=t.indexOf(e):k(t,function(t){return t===e})},A.invoke=function(t,e){var n=o.call(arguments,2),r=A.isFunction(e);return A.map(t,function(t){return(r?e:t[e]).apply(t,n)})},A.pluck=function(t,e){return A.map(t,function(t){return t[e]})},A.where=function(t,e,n){return A.isEmpty(e)?n?void 0:[]:A[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},A.findWhere=function(t,e){return A.where(t,e,!0)},A.max=function(t,e,n){if(!e&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&A.isEmpty(t))return-(1/0);var r={computed:-(1/0),value:-(1/0)};return E(t,function(t,i,s){var a=e?e.call(n,t,i,s):t;a>r.computed&&(r={value:t,computed:a})}),r.value},A.min=function(t,e,n){if(!e&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&A.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return E(t,function(t,i,s){var a=e?e.call(n,t,i,s):t;a<r.computed&&(r={value:t,computed:a})}),r.value},A.shuffle=function(t){var e,n=0,r=[];return E(t,function(t){e=A.random(n++),r[n-1]=r[e],r[e]=t}),r};var S=function(t){return A.isFunction(t)?t:function(e){return e[t]}};A.sortBy=function(t,e,n){var r=S(e);return A.pluck(A.map(t,function(t,e,i){return{value:t,index:e,criteria:r.call(n,t,e,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index<e.index?-1:1}),"value")};var F=function(t,e,n,r){var i={},s=S(null==e?A.identity:e);return E(t,function(e,a){var o=s.call(n,e,a,t);r(i,o,e)}),i};A.groupBy=function(t,e,n){return F(t,e,n,function(t,e,n){(A.has(t,e)?t[e]:t[e]=[]).push(n)})},A.countBy=function(t,e,n){return F(t,e,n,function(t,e){A.has(t,e)||(t[e]=0),t[e]++})},A.sortedIndex=function(t,e,n,r){n=null==n?A.identity:S(n);for(var i=n.call(r,e),s=0,a=t.length;a>s;){var o=s+a>>>1;n.call(r,t[o])<i?s=o+1:a=o}return s},A.toArray=function(t){return t?A.isArray(t)?o.call(t):t.length===+t.length?A.map(t,A.identity):A.values(t):[]},A.size=function(t){return null==t?0:t.length===+t.length?t.length:A.keys(t).length},A.first=A.head=A.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:o.call(t,0,e)},A.initial=function(t,e,n){return o.call(t,0,t.length-(null==e||n?1:e))},A.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:o.call(t,Math.max(t.length-e,0))},A.rest=A.tail=A.drop=function(t,e,n){return o.call(t,null==e||n?1:e)},A.compact=function(t){return A.filter(t,A.identity)};var M=function(t,e,n){return e&&A.every(t,A.isArray)?c.apply(n,t):(E(t,function(t){A.isArray(t)||A.isArguments(t)?e?a.apply(n,t):M(t,e,n):n.push(t)}),n)};A.flatten=function(t,e){return M(t,e,[])},A.without=function(t){return A.difference(t,o.call(arguments,1))},A.uniq=A.unique=function(t,e,n,r){A.isFunction(e)&&(r=n,n=e,e=!1);var i=n?A.map(t,n,r):t,s=[],a=[];return E(i,function(n,r){(e?r&&a[a.length-1]===n:A.contains(a,n))||(a.push(n),s.push(t[r]))}),s},A.union=function(){return A.uniq(A.flatten(arguments,!0))},A.intersection=function(t){var e=o.call(arguments,1);return A.filter(A.uniq(t),function(t){return A.every(e,function(e){return A.indexOf(e,t)>=0})})},A.difference=function(t){var e=c.apply(r,o.call(arguments,1));return A.filter(t,function(t){return!A.contains(e,t)})},A.zip=function(){for(var t=A.max(A.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;t>n;n++)e[n]=A.pluck(arguments,""+n);return e},A.object=function(t,e){if(null==t)return{};for(var n={},r=0,i=t.length;i>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},A.indexOf=function(t,e,n){if(null==t)return-1;var r=0,i=t.length;if(n){if("number"!=typeof n)return r=A.sortedIndex(t,e),t[r]===e?r:-1;r=0>n?Math.max(0,i+n):n}if(v&&t.indexOf===v)return t.indexOf(e,n);for(;i>r;r++)if(t[r]===e)return r;return-1},A.lastIndexOf=function(t,e,n){if(null==t)return-1;var r=null!=n;if(y&&t.lastIndexOf===y)return r?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var i=r?n:t.length;i--;)if(t[i]===e)return i;return-1},A.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=0,s=new Array(r);r>i;)s[i++]=t,t+=n;return s};var R=function(){};A.bind=function(t,e){var n,r;if(w&&t.bind===w)return w.apply(t,o.call(arguments,1));if(!A.isFunction(t))throw new TypeError;return n=o.call(arguments,2),r=function(){if(!(this instanceof r))return t.apply(e,n.concat(o.call(arguments)));R.prototype=t.prototype;var i=new R;R.prototype=null;var s=t.apply(i,n.concat(o.call(arguments)));return Object(s)===s?s:i}},A.partial=function(t){var e=o.call(arguments,1);return function(){return t.apply(this,e.concat(o.call(arguments)))}},A.bindAll=function(t){var e=o.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return E(e,function(e){t[e]=A.bind(t[e],t)}),t},A.memoize=function(t,e){var n={};return e||(e=A.identity),function(){var r=e.apply(this,arguments);return A.has(n,r)?n[r]:n[r]=t.apply(this,arguments)}},A.delay=function(t,e){var n=o.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},A.defer=function(t){return A.delay.apply(A,[t,1].concat(o.call(arguments,1)))},A.throttle=function(t,e,n){var r,i,s,a=null,o=0;n||(n={});var c=function(){o=n.leading===!1?0:new Date,a=null,s=t.apply(r,i)};return function(){var l=new Date;o||n.leading!==!1||(o=l);var h=e-(l-o);return r=this,i=arguments,0>=h?(clearTimeout(a),a=null,o=l,s=t.apply(r,i)):a||n.trailing===!1||(a=setTimeout(c,h)),s}},A.debounce=function(t,e,n){var r,i=null;return function(){var s=this,a=arguments,o=function(){i=null,n||(r=t.apply(s,a))},c=n&&!i;return clearTimeout(i),i=setTimeout(o,e),c&&(r=t.apply(s,a)),r}},A.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},A.wrap=function(t,e){return function(){var n=[t];return a.apply(n,arguments),e.apply(this,n)}},A.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},A.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},A.keys=b||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)A.has(t,n)&&e.push(n);return e},A.values=function(t){var e=[];for(var n in t)A.has(t,n)&&e.push(t[n]);return e},A.pairs=function(t){var e=[];for(var n in t)A.has(t,n)&&e.push([n,t[n]]);return e},A.invert=function(t){var e={};for(var n in t)A.has(t,n)&&(e[t[n]]=n);return e},A.functions=A.methods=function(t){var e=[];for(var n in t)A.isFunction(t[n])&&e.push(n);return e.sort()},A.extend=function(t){return E(o.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},A.pick=function(t){var e={},n=c.apply(r,o.call(arguments,1));return E(n,function(n){n in t&&(e[n]=t[n])}),e},A.omit=function(t){var e={},n=c.apply(r,o.call(arguments,1));for(var i in t)A.contains(n,i)||(e[i]=t[i]);return e},A.defaults=function(t){return E(o.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},A.clone=function(t){return A.isObject(t)?A.isArray(t)?t.slice():A.extend({},t):t},A.tap=function(t,e){return e(t),t};var P=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof A&&(t=t._wrapped),e instanceof A&&(e=e._wrapped);var i=l.call(t);if(i!=l.call(e))return!1;switch(i){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=n.length;s--;)if(n[s]==t)return r[s]==e;var a=t.constructor,o=e.constructor;if(a!==o&&!(A.isFunction(a)&&a instanceof a&&A.isFunction(o)&&o instanceof o))return!1;n.push(t),r.push(e);var c=0,h=!0;if("[object Array]"==i){if(c=t.length,h=c==e.length)for(;c--&&(h=P(t[c],e[c],n,r)););}else{for(var u in t)if(A.has(t,u)&&(c++,!(h=A.has(e,u)&&P(t[u],e[u],n,r))))break;if(h){for(u in e)if(A.has(e,u)&&!c--)break;h=!c}}return n.pop(),r.pop(),h};A.isEqual=function(t,e){return P(t,e,[],[])},A.isEmpty=function(t){if(null==t)return!0;if(A.isArray(t)||A.isString(t))return 0===t.length;for(var e in t)if(A.has(t,e))return!1;return!0},A.isElement=function(t){return!(!t||1!==t.nodeType)},A.isArray=x||function(t){return"[object Array]"==l.call(t)},A.isObject=function(t){return t===Object(t)},E(["Arguments","Function","String","Number","Date","RegExp"],function(t){A["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),A.isArguments(arguments)||(A.isArguments=function(t){return!(!t||!A.has(t,"callee"))}),"function"!=typeof/./&&(A.isFunction=function(t){return"function"==typeof t}),A.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},A.isNaN=function(t){return A.isNumber(t)&&t!=+t},A.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==l.call(t)},A.isNull=function(t){return null===t},A.isUndefined=function(t){return void 0===t},A.has=function(t,e){return h.call(t,e)},A.noConflict=function(){return t._=e,this},A.identity=function(t){return t},A.times=function(t,e,n){for(var r=Array(Math.max(0,t)),i=0;t>i;i++)r[i]=e.call(n,i);return r},A.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};T.unescape=A.invert(T.escape);var O={escape:new RegExp("["+A.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+A.keys(T.unescape).join("|")+")","g")};A.each(["escape","unescape"],function(t){A[t]=function(e){return null==e?"":(""+e).replace(O[t],function(e){return T[t][e]})}}),A.result=function(t,e){if(null==t)return void 0;var n=t[e];return A.isFunction(n)?n.call(t):n},A.mixin=function(t){E(A.functions(t),function(e){var n=A[e]=t[e];A.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),N.call(this,n.apply(A,t))}})};var U=0;A.uniqueId=function(t){var e=++U+"";return t?t+e:e},A.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;A.template=function(t,e,n){var r;n=A.defaults({},n,A.templateSettings);var i=new RegExp([(n.escape||j).source,(n.interpolate||j).source,(n.evaluate||j).source].join("|")+"|$","g"),s=0,a="__p+='";t.replace(i,function(e,n,r,i,o){return a+=t.slice(s,o).replace(L,function(t){return"\\"+B[t]}),n&&(a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(a+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(a+="';\n"+i+"\n__p+='"),s=o+e.length,e}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{r=new Function(n.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(e)return r(e,A);var c=function(t){return r.call(this,t,A)};return c.source="function("+(n.variable||"obj")+"){\n"+a+"}",c},A.chain=function(t){return A(t).chain()};var N=function(t){return this._chain?A(t).chain():t};A.mixin(A),E(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];A.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],N.call(this,n)}}),E(["concat","join","slice"],function(t){var e=r[t];A.prototype[t]=function(){return N.call(this,e.apply(this._wrapped,arguments))}}),A.extend(A.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};!function(){var t=[],e=t.slice,n=function(t,e,n){var r,i=-1,s=e.length;switch(n.length){case 0:for(;++i<s;)(r=e[i]).callback.call(r.ctx);return;case 1:for(;++i<s;)(r=e[i]).callback.call(r.ctx,n[0]);return;case 2:for(;++i<s;)(r=e[i]).callback.call(r.ctx,n[0],n[1]);return;case 3:for(;++i<s;)(r=e[i]).callback.call(r.ctx,n[0],n[1],n[2]);return;default:for(;++i<s;)(r=e[i]).callback.apply(r.ctx,n)}},r=Backbone.Events={on:function(t,e,n){this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){var r=this,i=_.once(function(){r.off(t,i),e.apply(this,arguments)});return i._callback=e,this.on(t,i,n),this},off:function(t,e,n){var r,i,s,a,o,c,l,h;if(!this._events)return this;if(!t&&!e&&!n)return this._events={},this;for(a=t?[t]:_.keys(this._events),o=0,c=a.length;c>o;o++)if(t=a[o],r=this._events[t]){if(s=[],e||n)for(l=0,h=r.length;h>l;l++)i=r[l],(e&&e!==(i.callback._callback||i.callback)||n&&n!==i.context)&&s.push(i);this._events[t]=s}return this},trigger:function(t){if(!this._events)return this;var r=e.call(arguments,1),i=this._events[t],s=this._events.all;return i&&n(this,i,r),s&&n(this,s,arguments),this},listenTo:function(t,e,n){var r=this._listeners||(this._listeners={}),i=t._listenerId||(t._listenerId=_.uniqueId("l"));return r[i]=t,t.on(e,n||this,this),this},stopListening:function(t,e,n){var r=this._listeners;if(r){if(t)t.off(e,n,this),e||n||delete r[t._listenerId];else{for(var i in r)r[i].off(null,null,this);this._listeners={}}return this}}};r.bind=r.on,r.unbind=r.off,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=r),exports.Backbone=exports.Backbone||Backbone)}(),function(){function t(t,r){var i=(new Date).getTime(),s=Math.max(0,16-(i-n)),a=e.setTimeout(function(){t(i+s)},s);return n=i+s,a}var e=this,n=0,r=["ms","moz","webkit","o"];if("undefined"!=typeof exports)return"undefined"!=typeof module&&module.exports&&(exports=module.exports=t),void(exports.requestAnimationFrame=t);for(var i=0;i<r.length&&!e.requestAnimationFrame;++i)e.requestAnimationFrame=e[r[i]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[r[i]+"CancelAnimationFrame"]||e[r[i]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=t),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(){function t(){var t=document.body.getBoundingClientRect(),e=this.width=t.width,n=this.height=t.height;this.renderer.setSize(e,n,this.ratio),this.trigger(m.Events.resize,e,n)}function e(){return(n.performance&&n.performance.now?n.performance:Date).now()}var n=this,r=n.Two||{},i=Math.sin,s=Math.cos,a=Math.atan2,o=Math.sqrt,c=(Math.round,Math.abs,Math.PI),l=2*c,h=c/2,u=Math.pow,f=Math.min,d=Math.max,p=0,g={hasEventListeners:_.isFunction(n.addEventListener),bind:function(t,e,n,r){return this.hasEventListeners?t.addEventListener(e,n,!!r):t.attachEvent("on"+e,n),this},unbind:function(t,e,n,r){return this.hasEventListeners?t.removeEventListeners(e,n,!!r):t.detachEvent("on"+e,n),this}},m=n.Two=function(e){var r=_.defaults(e||{},{fullscreen:!1,width:640,height:480,type:m.Types.svg,autostart:!1});if(_.each(r,function(t,e){"fullscreen"!==e&&"width"!==e&&"height"!==e&&"autostart"!==e&&(this[e]=t)},this),_.isElement(r.domElement)&&(this.type=m.Types[r.domElement.tagName.toLowerCase()]),this.renderer=new m[this.type](this),m.Utils.setPlaying.call(this,r.autostart),this.frameCount=0,r.fullscreen){var i=_.bind(t,this);_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),g.bind(n,"resize",i),i()}else _.isElement(r.domElement)||(this.renderer.setSize(r.width,r.height,this.ratio),this.width=r.width,this.height=r.height);this.scene=this.renderer.scene,m.Instances.push(this)};_.extend(m,{Array:n.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.4.0",Identifier:"two_",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){return n.Two=r,this},uniqueId:function(){var t=p;return p++,t},Utils:{release:function(t){_.isObject(t)&&(_.isFunction(t.unbind)&&t.unbind(),t.vertices&&(_.isFunction(t.vertices.unbind)&&t.vertices.unbind(),_.each(t.vertices,function(t){_.isFunction(t.unbind)&&t.unbind()})),t.children&&_.each(t.children,function(t){m.Utils.release(t)}))},Curve:{CollinearityEpsilon:u(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:.01},abscissas:[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights:[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]]},devicePixelRatio:n.devicePixelRatio||1,getBackingStoreRatio:function(t){return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1},getRatio:function(t){return m.Utils.devicePixelRatio/A(t)},setPlaying:function(t){return this.playing=!!t,this},getComputedMatrix:function(t,e){e=e&&e.identity()||new m.Matrix;for(var n=t,r=[];n&&n._matrix;)r.push(n._matrix),n=n.parent;return r.reverse(),_.each(r,function(t){var n=t.elements;e.multiply(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9])}),e},deltaTransformPoint:function(t,e,n){var r=e*t.a+n*t.c+0,i=e*t.b+n*t.d+0;return new m.Vector(r,i)},decomposeMatrix:function(t){var e=m.Utils.deltaTransformPoint(t,0,1),n=m.Utils.deltaTransformPoint(t,1,0),r=180/Math.PI*Math.atan2(e.y,e.x)-90,i=180/Math.PI*Math.atan2(n.y,n.x);return{translateX:t.e,translateY:t.f,scaleX:Math.sqrt(t.a*t.a+t.b*t.b),scaleY:Math.sqrt(t.c*t.c+t.d*t.d),skewX:r,skewY:i,rotation:r}},applySvgAttributes:function(t,e){var n,r,i,s,a={},o={};if(getComputedStyle){var c=getComputedStyle(t);for(n=c.length;n--;)r=c[n],i=c[r],void 0!==i&&(o[r]=i)}for(n=t.attributes.length;n--;)s=t.attributes[n],a[s.nodeName]=s.value;_.isUndefined(o.opacity)||(o["stroke-opacity"]=o.opacity,o["fill-opacity"]=o.opacity),_.extend(o,a),o.visible=!(_.isUndefined(o.display)&&"none"===o.display)||_.isUndefined(o.visibility)&&"hidden"===o.visibility;for(r in o)switch(i=o[r],r){case"transform":if("none"===i)break;var l=t.getCTM();if(null===l)break;var h=m.Utils.decomposeMatrix(t.getCTM());e.translation.set(h.translateX,h.translateY),e.rotation=h.rotation,e.scale=h.scaleX,o.x&&(e.translation.x=o.x),o.y&&(e.translation.y=o.y);break;case"visible":e.visible=i;break;case"stroke-linecap":e.cap=i;break;case"stroke-linejoin":e.join=i;break;case"stroke-miterlimit":e.miter=i;break;case"stroke-width":e.linewidth=parseFloat(i);break;case"stroke-opacity":case"fill-opacity":case"opacity":e.opacity=parseFloat(i);break;case"fill":case"stroke":e[r]="none"===i?"transparent":i;break;case"id":e.id=i;break;case"class":e.classList=i.split(" ")}return e},read:{svg:function(){return m.Utils.read.g.apply(this,arguments)},g:function(t){var e=new m.Group;m.Utils.applySvgAttributes(t,e);for(var n=0,r=t.childNodes.length;r>n;n++){var i=t.childNodes[n],s=i.nodeName;if(!s)return;var a=s.replace(/svg\:/gi,"").toLowerCase();if(a in m.Utils.read){var o=m.Utils.read[a].call(this,i);e.add(o)}}return e},polygon:function(t,e){var n=t.getAttribute("points"),r=[];n.replace(/(-?[\d\.?]+),(-?[\d\.?]+)/g,function(t,e,n){r.push(new m.Anchor(parseFloat(e),parseFloat(n)))});var i=new m.Polygon(r,!e).noStroke();return i.fill="black",m.Utils.applySvgAttributes(t,i)},polyline:function(t){return m.Utils.read.polygon(t,!0)},path:function(t){var e,n,r=t.getAttribute("d"),i=new m.Anchor,s=!1,a=!1,o=r.match(/[a-df-z][^a-df-z]*/gi),c=o.length-1;_.each(o.slice(0),function(t,e){var n,r=t[0],i=r.toLowerCase(),s=t.slice(1).trim().split(/[\s,]+|(?=\s?[+\-])/),a=[];switch(0>=e&&(o=[]),i){case"h":case"v":s.length>1&&(n=1);break;case"m":case"l":case"t":s.length>2&&(n=2);break;case"s":case"q":s.length>4&&(n=4);break;case"c":s.length>6&&(n=6);break;case"a":}if(n){for(var c=0,l=s.length,h=0;l>c;c+=n){var u=r;if(h>0)switch(r){case"m":u="l";break;case"M":u="L"}a.push([u].concat(s.slice(c,c+n)).join(" ")),h++}o=Array.prototype.concat.apply(o,a)}else o.push(t)});var l=_.flatten(_.map(o,function(t,r){var o,l,h,f=t[0],d=f.toLowerCase();n=t.slice(1).trim(),n=n.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(t,e,n){return parseFloat(e)*u(10,n)}),n=n.split(/[\s,]+|(?=\s?[+\-])/),a=f===d;var p,g,v,y,x,b,w,A,E;switch(d){case"z":r>=c?s=!0:(l=i.x,h=i.y,o=new m.Anchor(l,h,void 0,void 0,void 0,void 0,m.Commands.close));break;case"m":case"l":l=parseFloat(n[0]),h=parseFloat(n[1]),o=new m.Anchor(l,h,void 0,void 0,void 0,void 0,"m"===d?m.Commands.move:m.Commands.line),a&&o.addSelf(i),i=o;break;case"h":case"v":var C="h"===d?"x":"y",S="x"===C?"y":"x";o=new m.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,m.Commands.line),o[C]=parseFloat(n[0]),o[S]=i[S],a&&(o[C]+=i[C]),i=o;break;case"c":case"s":p=i.x,g=i.y,e||(e=new m.Vector),"c"===d?(v=parseFloat(n[0]),y=parseFloat(n[1]),x=parseFloat(n[2]),b=parseFloat(n[3]),w=parseFloat(n[4]),A=parseFloat(n[5])):(E=k(i,e,a),v=E.x,y=E.y,x=parseFloat(n[0]),b=parseFloat(n[1]),w=parseFloat(n[2]),A=parseFloat(n[3])),a&&(v+=p,y+=g,x+=p,b+=g,w+=p,A+=g),_.isObject(i.controls)||m.Anchor.AppendCurveProperties(i),i.controls.right.set(v-i.x,y-i.y),o=new m.Anchor(w,A,x-w,b-A,void 0,void 0,m.Commands.curve),i=o,e=o.controls.left;break;case"t":case"q":p=i.x,g=i.y,e||(e=new m.Vector),e.isZero()?(v=p,y=g):(v=e.x,g=e.y),"q"===d?(x=parseFloat(n[0]),b=parseFloat(n[1]),w=parseFloat(n[1]),A=parseFloat(n[2])):(E=k(i,e,a),x=E.x,b=E.y,w=parseFloat(n[0]),A=parseFloat(n[1])),a&&(v+=p,y+=g,x+=p,b+=g,w+=p,A+=g),_.isObject(i.controls)||m.Anchor.AppendCurveProperties(i),i.controls.right.set(v-i.x,y-i.y),o=new m.Anchor(w,A,x-w,b-A,void 0,void 0,m.Commands.curve),i=o,e=o.controls.left;break;case"a":throw new m.Utils.Error("not yet able to interpret Elliptical Arcs.")}return o}));if(!(l.length<=1)){l=_.compact(l);var h=new m.Polygon(l,s,void 0,!0).noStroke();return h.fill="black",m.Utils.applySvgAttributes(t,h)}},circle:function(t){var e=parseFloat(t.getAttribute("cx")),n=parseFloat(t.getAttribute("cy")),r=parseFloat(t.getAttribute("r")),a=m.Resolution,o=_.map(_.range(a),function(t){var e=t/a,n=e*l,o=r*s(n),c=r*i(n);return new m.Anchor(o,c)},this),c=new m.Polygon(o,!0,!0).noStroke();return c.translation.set(e,n),c.fill="black",m.Utils.applySvgAttributes(t,c)},ellipse:function(t){var e=parseFloat(t.getAttribute("cx")),n=parseFloat(t.getAttribute("cy")),r=parseFloat(t.getAttribute("rx")),a=parseFloat(t.getAttribute("ry")),o=m.Resolution,c=_.map(_.range(o),function(t){var e=t/o,n=e*l,c=r*s(n),h=a*i(n);return new m.Anchor(c,h)},this),h=new m.Polygon(c,!0,!0).noStroke();return h.translation.set(e,n),h.fill="black",m.Utils.applySvgAttributes(t,h)},rect:function(t){var e=parseFloat(t.getAttribute("x")),n=parseFloat(t.getAttribute("y")),r=parseFloat(t.getAttribute("width")),i=parseFloat(t.getAttribute("height")),s=r/2,a=i/2,o=[new m.Anchor(s,a),new m.Anchor(-s,a),new m.Anchor(-s,-a),new m.Anchor(s,-a)],c=new m.Polygon(o,!0).noStroke();return c.translation.set(e+s,n+a),c.fill="black",m.Utils.applySvgAttributes(t,c)},line:function(t){var e=parseFloat(t.getAttribute("x1")),n=parseFloat(t.getAttribute("y1")),r=parseFloat(t.getAttribute("x2")),i=parseFloat(t.getAttribute("y2")),s=r-e,a=i-n,o=s/2,c=a/2,l=[new m.Anchor(-o,-c),new m.Anchor(o,c)],h=new m.Polygon(l).noFill();return h.translation.set(e+o,n+c),m.Utils.applySvgAttributes(t,h)}},subdivide:function(t,e,n,r,i,s,a,o,c){c=c||m.Utils.Curve.RecursionLimit;var l=c+1;return t===a&&e===o?[new m.Anchor(a,o)]:_.map(_.range(0,l),function(c){var h=c/l,u=E(h,t,n,i,a),f=E(h,e,r,s,o);return new m.Anchor(u,f)})},getPointOnCubicBezier:function(t,e,n,r,i){var s=1-t;return s*s*s*e+3*s*s*t*n+3*s*t*t*r+t*t*t*i},getCurveLength:function(t,e,n,r,i,s,a,c,l){if(t===n&&e===r&&i===a&&s===c){var h=a-t,u=c-e;return o(h*h+u*u)}var f=9*(n-i)+3*(a-t),d=6*(t+i)-12*n,p=3*(n-t),g=9*(r-s)+3*(c-e),_=6*(e+s)-12*r,v=3*(r-e),y=function(t){var e=(f*t+d)*t+p,n=(g*t+_)*t+v;return o(e*e+n*n)};return C(y,0,1,l||m.Utils.Curve.RecursionLimit)},integrate:function(t,e,n,r){for(var i=m.Utils.Curve.abscissas[r-2],s=m.Utils.Curve.weights[r-2],a=.5*(n-e),o=a+e,c=0,l=r+1>>1,h=1&r?s[c++]*t(o):0;l>c;){var u=a*i[c];h+=s[c++]*(t(o+u)+t(o-u))}return a*h},getCurveFromPoints:function(t,e){for(var n=t.length,r=n-1,i=0;n>i;i++){var s=t[i];_.isObject(s.controls)||m.Anchor.AppendCurveProperties(s);var a=e?w(i-1,n):d(i-1,0),o=e?w(i+1,n):f(i+1,r),c=t[a],l=s,h=t[o];b(c,l,h),l._command=0===i?m.Commands.move:m.Commands.curve,l.controls.left.x=_.isNumber(l.controls.left.x)?l.controls.left.x:l.x,l.controls.left.y=_.isNumber(l.controls.left.y)?l.controls.left.y:l.y,l.controls.right.x=_.isNumber(l.controls.right.x)?l.controls.right.x:l.x,l.controls.right.y=_.isNumber(l.controls.right.y)?l.controls.right.y:l.y}},getControlPoints:function(t,e,n){var r=x(t,e),a=x(n,e),o=v(t,e),l=v(n,e),u=(r+a)/2;return e.u=_.isObject(e.controls.left)?e.controls.left:new m.Vector(0,0),e.v=_.isObject(e.controls.right)?e.controls.right:new m.Vector(0,0),1e-4>o||1e-4>l?(e._relative||(e.controls.left.copy(e),e.controls.right.copy(e)),e):(o*=.33,l*=.33,r>a?u+=h:u-=h,e.controls.left.x=s(u)*o,e.controls.left.y=i(u)*o,u-=c,e.controls.right.x=s(u)*l,e.controls.right.y=i(u)*l,e._relative||(e.controls.left.x+=e.x,e.controls.left.y+=e.y,e.controls.right.x+=e.x,e.controls.right.y+=e.y),e)},getReflection:function(t,e,n){return new m.Vector(2*t.x-(e.x+t.x)-(n?t.x:0),2*t.y-(e.y+t.y)-(n?t.y:0))},angleBetween:function(t,e){var n,r;return arguments.length>=4?(n=arguments[0]-arguments[2],r=arguments[1]-arguments[3],a(r,n)):(n=t.x-e.x,r=t.y-e.y,a(r,n))},distanceBetweenSquared:function(t,e){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r},distanceBetween:function(t,e){return o(y(t,e))},toFixed:function(t){return Math.floor(1e3*t)/1e3},mod:function(t,e){for(;0>t;)t+=e;return t%e},Collection:function(){Array.call(this),arguments.length>1?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(t){this.name="two.js",this.message=t}}}),m.Utils.Error.prototype=new Error,m.Utils.Error.prototype.constructor=m.Utils.Error,m.Utils.Collection.prototype=new Array,m.Utils.Collection.constructor=m.Utils.Collection,_.extend(m.Utils.Collection.prototype,Backbone.Events,{pop:function(){var t=Array.prototype.pop.apply(this,arguments);return this.trigger(m.Events.remove,[t]),t},shift:function(){var t=Array.prototype.shift.apply(this,arguments);return this.trigger(m.Events.remove,[t]),t},push:function(){var t=Array.prototype.push.apply(this,arguments);return this.trigger(m.Events.insert,arguments),t},unshift:function(){var t=Array.prototype.unshift.apply(this,arguments);return this.trigger(m.Events.insert,arguments),t},splice:function(){var t,e=Array.prototype.splice.apply(this,arguments);return this.trigger(m.Events.remove,e),arguments.length>2&&(t=this.slice(arguments[0],arguments.length-2),this.trigger(m.Events.insert,t)),e}});var v=m.Utils.distanceBetween,y=m.Utils.distanceBetweenSquared,x=m.Utils.angleBetween,b=m.Utils.getControlPoints,w=(m.Utils.getCurveFromPoints,m.Utils.solveSegmentIntersection,m.Utils.decoupleShapes,m.Utils.mod),A=m.Utils.getBackingStoreRatio,E=m.Utils.getPointOnCubicBezier,C=(m.Utils.getCurveLength,m.Utils.integrate),k=m.Utils.getReflection;_.extend(m.prototype,Backbone.Events,{appendTo:function(t){return t.appendChild(this.renderer.domElement),
this},play:function(){return m.Utils.setPlaying.call(this,!0),this.trigger(m.Events.play)},pause:function(){return this.playing=!1,this.trigger(m.Events.pause)},update:function(){var t=!!this._lastFrame,n=e();this.frameCount++,t&&(this.timeDelta=parseFloat((n-this._lastFrame).toFixed(3))),this._lastFrame=n;var r=this.width,i=this.height,s=this.renderer;return(r!==s.width||i!==s.height)&&s.setSize(r,i,this.ratio),this.trigger(m.Events.update,this.frameCount,this.timeDelta),this.render()},render:function(){return this.renderer.render(),this.trigger(m.Events.render,this.frameCount)},add:function(t){var e=t;return _.isArray(t)||(e=_.toArray(arguments)),this.scene.add(e),this},remove:function(t){var e=t;return _.isArray(t)||(e=_.toArray(arguments)),this.scene.remove(e),this},clear:function(){return this.scene.remove(_.toArray(this.scene.children)),this},makeLine:function(t,e,n,r){var i=n-t,s=r-e,a=i/2,o=s/2,c=[new m.Anchor(-a,-o),new m.Anchor(a,o)],l=new m.Polygon(c).noFill();return l.translation.set(t+a,e+o),this.scene.add(l),l},makeRectangle:function(t,e,n,r){var i=n/2,s=r/2,a=[new m.Anchor(-i,-s),new m.Anchor(i,-s),new m.Anchor(i,s),new m.Anchor(-i,s)],o=new m.Polygon(a,!0);return o.translation.set(t,e),this.scene.add(o),o},makeCircle:function(t,e,n){return this.makeEllipse(t,e,n,n)},makeEllipse:function(t,e,n,r){var a=m.Resolution,o=_.map(_.range(a),function(t){var e=t/a,o=e*l,c=n*s(o),h=r*i(o);return new m.Anchor(c,h)},this),c=new m.Polygon(o,!0,!0);return c.translation.set(t,e),this.scene.add(c),c},makeCurve:function(t){var e=arguments.length,n=t;if(!_.isArray(t)){n=[];for(var r=0;e>r;r+=2){var i=arguments[r];if(!_.isNumber(i))break;var s=arguments[r+1];n.push(new m.Anchor(i,s))}}var a=arguments[e-1],o=new m.Polygon(n,!(_.isBoolean(a)?a:void 0),!0),c=o.getBoundingClientRect(),l=c.left+c.width/2,h=c.top+c.height/2;return _.each(o.vertices,function(t){t.x-=l,t.y-=h}),o.translation.set(l,h),this.scene.add(o),o},makePolygon:function(t){var e=arguments.length,n=t;if(!_.isArray(t)){n=[];for(var r=0;e>r;r+=2){var i=arguments[r];if(!_.isNumber(i))break;var s=arguments[r+1];n.push(new m.Anchor(i,s))}}var a=arguments[e-1],o=new m.Polygon(n,!(_.isBoolean(a)?a:void 0)),c=o.getBoundingClientRect();return o.center().translation.set(c.left+c.width/2,c.top+c.height/2),this.scene.add(o),o},makeGroup:function(t){var e=t;_.isArray(t)||(e=_.toArray(arguments));var n=new m.Group;return this.scene.add(n),n.add(e),n},interpret:function(t,e){var n=t.tagName.toLowerCase();if(!(n in m.Utils.read))return null;var r=m.Utils.read[n].call(this,t);return e&&r instanceof m.Group?this.add(_.values(r.children)):this.add(r),r}}),function(){requestAnimationFrame(arguments.callee),m.Instances.forEach(function(t){t.playing&&t.update()})}(),"function"==typeof define&&define.amd?define(function(){return m}):"undefined"!=typeof module&&module.exports&&(module.exports=m)}(),function(t){var e=t.Vector=function(t,e){this.x=t||0,this.y=e||0};_.extend(e,{zero:new t.Vector}),_.extend(e.prototype,Backbone.Events,{set:function(t,e){return this.x=t,this.y=e,this},copy:function(t){return this.x=t.x,this.y=t.y,this},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new e(this.x,this.y)},add:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addSelf:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},subSelf:function(t){return this.x-=t.x,this.y-=t.y,this},multiplySelf:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){return t?(this.x/=t,this.y/=t):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},setLength:function(t){return this.normalize().multiplyScalar(t)},equals:function(t){return this.distanceTo(t)<1e-4},lerp:function(t,e){var n=(t.x-this.x)*e+this.x,r=(t.y-this.y)*e+this.y;return this.set(n,r)},isZero:function(){return this.length()<1e-4},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var n={set:function(e,n){return this._x=e,this._y=n,this.trigger(t.Events.change)},copy:function(e){return this._x=e.x,this._y=e.y,this.trigger(t.Events.change)},clear:function(){return this._x=0,this._y=0,this.trigger(t.Events.change)},clone:function(){return new e(this._x,this._y)},add:function(e,n){return this._x=e.x+n.x,this._y=e.y+n.y,this.trigger(t.Events.change)},addSelf:function(e){return this._x+=e.x,this._y+=e.y,this.trigger(t.Events.change)},sub:function(e,n){return this._x=e.x-n.x,this._y=e.y-n.y,this.trigger(t.Events.change)},subSelf:function(e){return this._x-=e.x,this._y-=e.y,this.trigger(t.Events.change)},multiplySelf:function(e){return this._x*=e.x,this._y*=e.y,this.trigger(t.Events.change)},multiplyScalar:function(e){return this._x*=e,this._y*=e,this.trigger(t.Events.change)},divideScalar:function(e){return e?(this._x/=e,this._y/=e,this.trigger(t.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this._x*t.x+this._y*t.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this._x-t.x,n=this._y-t.y;return e*e+n*n},setLength:function(t){return this.normalize().multiplyScalar(t)},equals:function(t){return this.distanceTo(t)<1e-4},lerp:function(t,e){var n=(t.x-this._x)*e+this._x,r=(t.y-this._y)*e+this._y;return this.set(n,r)},isZero:function(){return this.length()<1e-4},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},r={get:function(){return this._x},set:function(e){this._x=e,this.trigger(t.Events.change,"x")}},i={get:function(){return this._y},set:function(e){this._y=e,this.trigger(t.Events.change,"y")}};t.Vector.prototype.bind=t.Vector.prototype.on=function(){return this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",r),Object.defineProperty(this,"y",i),_.extend(this,n),this._bound=!0),Backbone.Events.bind.apply(this,arguments),this}}(Two),function(t){var e=t.Commands,n=t.Anchor=function(r,i,s,a,o,c,l){return t.Vector.call(this,r,i),this._broadcast=_.bind(function(){this.trigger(t.Events.change)},this),this._command=l||e.move,this._relative=!0,l?(n.AppendCurveProperties(this),_.isNumber(s)&&(this.controls.left.x=s),_.isNumber(a)&&(this.controls.left.y=a),_.isNumber(o)&&(this.controls.right.x=o),void(_.isNumber(c)&&(this.controls.right.y=c))):this};_.extend(n,{AppendCurveProperties:function(e){e.controls={left:new t.Vector(0,0),right:new t.Vector(0,0)}}});var r={listen:function(){return _.isObject(this.controls)||n.AppendCurveProperties(this),this.controls.left.bind(t.Events.change,this._broadcast),this.controls.right.bind(t.Events.change,this._broadcast),this},ignore:function(){return this.controls.left.unbind(t.Events.change,this._broadcast),this.controls.right.unbind(t.Events.change,this._broadcast),this},clone:function(){var e=this.controls,n=new t.Anchor(this.x,this.y,e&&e.left.x,e&&e.left.y,e&&e.right.x,e&&e.right.y,this.command);return n.relative=this._relative,n},toObject:function(){var t={x:this.x,y:this.y};return this._command&&(t.command=this._command),this._relative&&(t.relative=this._relative),this.controls&&(t.controls={left:this.controls.left.toObject(),right:this.controls.right.toObject()}),t}};Object.defineProperty(n.prototype,"command",{get:function(){return this._command},set:function(r){return this._command=r,this._command!==e.curve||_.isObject(this.controls)||n.AppendCurveProperties(this),this.trigger(t.Events.change)}}),Object.defineProperty(n.prototype,"relative",{get:function(){return this._relative},set:function(e){return this._relative==e?this:(this._relative=!!e,this.trigger(t.Events.change))}}),_.extend(n.prototype,t.Vector.prototype,r),t.Anchor.prototype.bind=t.Anchor.prototype.on=function(){t.Vector.prototype.bind.apply(this,arguments),_.extend(this,r)},t.Anchor.prototype.unbind=t.Anchor.prototype.off=function(){t.Vector.prototype.unbind.apply(this,arguments),_.extend(this,r)}}(Two),function(t){var e=Math.cos,n=Math.sin,r=Math.tan,i=t.Matrix=function(e,n,r,i,s,a){this.elements=new t.Array(9);var o=e;_.isArray(o)||(o=_.toArray(arguments)),this.identity().set(o)};_.extend(i,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(e,n,r){if(n.length<=3){var i,s,a,o=e,c=n[0]||0,l=n[1]||0,h=n[2]||0;return i=o[0]*c+o[1]*l+o[2]*h,s=o[3]*c+o[4]*l+o[5]*h,a=o[6]*c+o[7]*l+o[8]*h,{x:i,y:s,z:a}}var u=e[0],f=e[1],d=e[2],p=e[3],g=e[4],m=e[5],_=e[6],v=e[7],y=e[8],x=n[0],b=n[1],w=n[2],A=n[3],E=n[4],C=n[5],k=n[6],S=n[7],F=n[8];return r=r||new t.Array(9),r[0]=u*x+f*A+d*k,r[1]=u*b+f*E+d*S,r[2]=u*w+f*C+d*F,r[3]=p*x+g*A+m*k,r[4]=p*b+g*E+m*S,r[5]=p*w+g*C+m*F,r[6]=_*x+v*A+y*k,r[7]=_*b+v*E+y*S,r[8]=_*w+v*C+y*F,r}}),_.extend(i.prototype,Backbone.Events,{set:function(e){var n=e;return _.isArray(n)||(n=_.toArray(arguments)),_.extend(this.elements,n),this.trigger(t.Events.change)},identity:function(){return this.set(i.Identity),this},multiply:function(e,n,r,i,s,a,o,c,l){var h=arguments,u=h.length;if(1>=u)return _.each(this.elements,function(t,n){this.elements[n]=t*e},this),this.trigger(t.Events.change);if(3>=u){var f,d,p;return e=e||0,n=n||0,r=r||0,s=this.elements,f=s[0]*e+s[1]*n+s[2]*r,d=s[3]*e+s[4]*n+s[5]*r,p=s[6]*e+s[7]*n+s[8]*r,{x:f,y:d,z:p}}var g=this.elements,m=h,v=g[0],y=g[1],x=g[2],b=g[3],w=g[4],A=g[5],E=g[6],C=g[7],k=g[8],S=m[0],F=m[1],M=m[2],R=m[3],P=m[4],T=m[5],O=m[6],U=m[7],j=m[8];return this.elements[0]=v*S+y*R+x*O,this.elements[1]=v*F+y*P+x*U,this.elements[2]=v*M+y*T+x*j,this.elements[3]=b*S+w*R+A*O,this.elements[4]=b*F+w*P+A*U,this.elements[5]=b*M+w*T+A*j,this.elements[6]=E*S+C*R+k*O,this.elements[7]=E*F+C*P+k*U,this.elements[8]=E*M+C*T+k*j,this.trigger(t.Events.change)},inverse:function(e){var n=this.elements;e=e||new t.Matrix;var r=n[0],i=n[1],s=n[2],a=n[3],o=n[4],c=n[5],l=n[6],h=n[7],u=n[8],f=u*o-c*h,d=-u*a+c*l,p=h*a-o*l,g=r*f+i*d+s*p;return g?(g=1/g,e.elements[0]=f*g,e.elements[1]=(-u*i+s*h)*g,e.elements[2]=(c*i-s*o)*g,e.elements[3]=d*g,e.elements[4]=(u*r-s*l)*g,e.elements[5]=(-c*r+s*a)*g,e.elements[6]=p*g,e.elements[7]=(-h*r+i*l)*g,e.elements[8]=(o*r-i*a)*g,e):null},scale:function(t,e){var n=arguments.length;return 1>=n&&(e=t),this.multiply(t,0,0,0,e,0,0,0,1)},rotate:function(t){var r=e(t),i=n(t);return this.multiply(r,-i,0,i,r,0,0,0,1)},translate:function(t,e){return this.multiply(1,0,t,0,1,e,0,0,1)},skewX:function(t){var e=r(t);return this.multiply(1,e,0,0,1,0,0,0,1)},skewY:function(t){var e=r(t);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(t){var e=[];return this.toArray(t,e),e.join(" ")},toArray:function(t,e){var n=this.elements,r=!!e,i=parseFloat(n[0].toFixed(3)),s=parseFloat(n[1].toFixed(3)),a=parseFloat(n[2].toFixed(3)),o=parseFloat(n[3].toFixed(3)),c=parseFloat(n[4].toFixed(3)),l=parseFloat(n[5].toFixed(3));if(t){var h=parseFloat(n[6].toFixed(3)),u=parseFloat(n[7].toFixed(3)),f=parseFloat(n[8].toFixed(3));return r?(e[0]=i,e[1]=o,e[2]=h,e[3]=s,e[4]=c,e[5]=u,e[6]=a,e[7]=l,void(e[8]=f)):[i,o,h,s,c,u,a,l,f]}return r?(e[0]=i,e[1]=o,e[2]=s,e[3]=c,e[4]=a,void(e[5]=l)):[i,o,s,c,a,l]},clone:function(){var e,n,r,i,s,a,o,c,l;return e=this.elements[0],n=this.elements[1],r=this.elements[2],i=this.elements[3],s=this.elements[4],a=this.elements[5],o=this.elements[6],c=this.elements[7],l=this.elements[8],new t.Matrix(e,n,r,i,s,a,o,c,l)}})}(Two),function(t){var e=t.Utils.mod,n=t.Utils.toFixed,r={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(t,e){var n=t,i=document.createElementNS(this.ns,n);return"svg"===n&&(e=_.defaults(e||{},{version:this.version})),_.isObject(e)&&r.setAttributes(i,e),i},setAttributes:function(t,e){for(var n in e)t.setAttribute(n,e[n]);return this},removeAttributes:function(t,e){for(var n in e)t.removeAttribute(n);return this},toString:function(r,i){for(var s,a=r.length,o=a-1,c="",l=0;a>l;l++){var h,u,f,d,p,g,m,_,v,y=r[l],x=i?e(l-1,a):Math.max(l-1,0),b=i?e(l+1,a):Math.min(l+1,o),w=r[x],A=r[b],E=n(y._x),C=n(y._y);switch(y._command){case t.Commands.close:h=t.Commands.close;break;case t.Commands.curve:g=w.controls&&w.controls.right||w,m=y.controls&&y.controls.left||y,w._relative?(u=n(g.x+w.x),f=n(g.y+w.y)):(u=n(g.x),f=n(g.y)),y._relative?(d=n(m.x+y.x),p=n(m.y+y.y)):(d=n(m.x),p=n(m.y)),h=(0===l?t.Commands.move:t.Commands.curve)+" "+u+" "+f+" "+d+" "+p+" "+E+" "+C;break;case t.Commands.move:s=y,h=t.Commands.move+" "+E+" "+C;break;default:h=y._command+" "+E+" "+C}l>=o&&i&&(y._command===t.Commands.curve&&(A=s,_=y.controls&&y.controls.right||y,v=A.controls&&A.controls.left||A,y._relative?(u=n(_.x+y.x),f=n(_.y+y.y)):(u=n(_.x),f=n(_.y)),A._relative?(d=n(v.x+A.x),p=n(v.y+A.y)):(d=n(v.x),p=n(v.y)),E=n(A.x),C=n(A.y),h+=" C "+u+" "+f+" "+d+" "+p+" "+E+" "+C),h+=" Z"),c+=h+" "}return c},getClip:function(t){if(clip=t._renderer.clip,!clip){for(root=t;root.parent;)root=root.parent;clip=t._renderer.clip=r.createElement("clipPath"),root.defs.appendChild(clip)}return clip},group:{appendChild:function(t){var e=this.domElement.querySelector("#"+t);if(e){var n=e.nodeName;if(n){var r=n.replace(/svg\:/gi,"").toLowerCase();/clippath/.test(r)||this.elem.appendChild(e)}}},removeChild:function(t){var e=this.domElement.querySelector("#"+t);if(e){var n=e.nodeName;if(n){var r=n.replace(/svg\:/gi,"").toLowerCase();/clippath/.test(r)||this.elem.removeChild(e)}}},renderChild:function(t){r[t._renderer.type].render.call(t,this)},render:function(t){if(this._update(),0===this._opacity&&!this._flagOpacity)return this;this._renderer.elem||(this._renderer.elem=r.createElement("g",{id:this.id}),t.appendChild(this._renderer.elem));var e=this._matrix.manual||this._flagMatrix,n={domElement:t,elem:this._renderer.elem};e&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");for(var i in this.children){var s=this.children[i];r[s._renderer.type].render.call(s,t)}return this._flagOpacity&&this._renderer.elem.setAttribute("opacity",this._opacity),this._flagAdditions&&_.each(this.additions,r.group.appendChild,n),this._flagSubtractions&&_.each(this.subtractions,r.group.removeChild,n),this._flagMask&&(this._mask?this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")"):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},polygon:{render:function(t){if(this._update(),0===this._opacity&&!this._flagOpacity)return this;var e={},n=this._matrix.manual||this._flagMatrix;if(n&&(e.transform="matrix("+this._matrix.toString()+")"),this._flagVertices){var i=r.toString(this._vertices,this._closed);e.d=i}return this._flagFill&&(e.fill=this._fill),this._flagStroke&&(e.stroke=this._stroke),this._flagLinewidth&&(e["stroke-width"]=this._linewidth),this._flagOpacity&&(e["stroke-opacity"]=this._opacity,e["fill-opacity"]=this._opacity),this._flagVisible&&(e.visibility=this._visible?"visible":"hidden"),this._flagCap&&(e["stroke-linecap"]=this._cap),this._flagJoin&&(e["stroke-linejoin"]=this._join),this._flagMiter&&(e["stroke-miterlimit"]=this.miter),this._renderer.elem?r.setAttributes(this._renderer.elem,e):(e.id=this.id,this._renderer.elem=r.createElement("path",e),t.appendChild(this._renderer.elem)),this._flagClip&&(clip=r.getClip(this),elem=this._renderer.elem,this._clip?(elem.removeAttribute("id"),clip.setAttribute("id",this.id),clip.appendChild(elem)):(clip.removeAttribute("id"),elem.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(elem))),this.flagReset()}}},i=t[t.Types.svg]=function(e){this.domElement=e.domElement||r.createElement("svg"),this.scene=new t.Group,this.scene.parent=this,this.defs=r.createElement("defs"),this.domElement.appendChild(this.defs)};_.extend(i,{Utils:r}),_.extend(i.prototype,Backbone.Events,{setSize:function(t,e){return this.width=t,this.height=e,r.setAttributes(this.domElement,{width:t,height:e}),this},render:function(){return r.group.render.call(this.scene,this.domElement),this}})}(Two),function(t){var e=t.Utils.mod,n=t.Utils.toFixed,r=t.Utils.getRatio,i={group:{renderChild:function(t){i[t._renderer.type].render.call(t,this.ctx,!0,this.clip)},render:function(t){this._update();var e=this._matrix.elements,n=this.parent;this._renderer.opacity=this._opacity*(n&&n._renderer?n._renderer.opacity:1);var r=this._mask;return this._renderer.context||(this._renderer.context={}),this._renderer.context.ctx=t,t.save(),t.transform(e[0],e[3],e[1],e[4],e[2],e[5]),r&&i[r._renderer.type].render.call(r,t,!0),_.each(this.children,i.group.renderChild,this._renderer.context),t.restore(),this.flagReset()}},polygon:{render:function(r,i,s){var a,o,c,l,h,u,f,d,p,g,m,v,y,x,b,w,A,E,C,k,S,F,M,R,P,T,O,U,j;return this._update(),a=this._matrix.elements,o=this._stroke,c=this._linewidth,l=this._fill,h=this._opacity*this.parent._renderer.opacity,u=this._visible,f=this._cap,d=this._join,p=this._miter,g=this._closed,m=this._vertices,v=m.length,y=v-1,j=this._clip,i||u&&!j?(r.save(),a&&r.transform(a[0],a[3],a[1],a[4],a[2],a[5]),l&&(r.fillStyle=l),o&&(r.strokeStyle=o),c&&(r.lineWidth=c),p&&(r.miterLimit=p),d&&(r.lineJoin=d),f&&(r.lineCap=f),_.isNumber(h)&&(r.globalAlpha=h),r.beginPath(),m.forEach(function(i,s){switch(O=n(i.x),U=n(i.y),i._command){case t.Commands.close:r.closePath();break;case t.Commands.curve:b=g?e(s-1,v):Math.max(s-1,0),x=g?e(s+1,v):Math.min(s+1,y),w=m[b],A=m[x],M=w.controls&&w.controls.right||w,R=i.controls&&i.controls.left||i,w._relative?(S=M.x+n(w.x),F=M.y+n(w.y)):(S=n(M.x),F=n(M.y)),i._relative?(C=R.x+n(i.x),k=R.y+n(i.y)):(C=n(R.x),k=n(R.y)),r.bezierCurveTo(S,F,C,k,O,U),s>=y&&g&&(A=E,P=i.controls&&i.controls.right||i,T=A.controls&&A.controls.left||A,i._relative?(S=P.x+n(i.x),F=P.y+n(i.y)):(S=n(P.x),F=n(P.y)),A._relative?(C=T.x+n(A.x),k=T.y+n(A.y)):(C=n(T.x),k=n(T.y)),O=n(A.x),U=n(A.y),r.bezierCurveTo(S,F,C,k,O,U));break;case t.Commands.line:r.lineTo(O,U);break;case t.Commands.move:E=i,r.moveTo(O,U)}}),g&&r.closePath(),j||s||(r.fill(),r.stroke()),r.restore(),j&&!s&&r.clip(),this.flagReset()):this}}},s=t[t.Types.canvas]=function(e){this.domElement=e.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=e.overdraw||!1,this.scene=new t.Group,this.scene.parent=this};_.extend(s,{Utils:i}),_.extend(s.prototype,Backbone.Events,{setSize:function(t,e,n){return this.width=t,this.height=e,this.ratio=_.isUndefined(n)?r(this.ctx):n,this.domElement.width=t*this.ratio,this.domElement.height=e*this.ratio,_.extend(this.domElement.style,{width:t+"px",height:e+"px"}),this},render:function(){var t=1===this.ratio;return t||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),i.group.render.call(this.scene,this.ctx),t||this.ctx.restore(),this}})}(Two),function(t){var e=t.Matrix.Multiply,n=t.Utils.mod,r=[1,0,0,0,1,0,0,0,1],i=new t.Array(9),s=t.Utils.getRatio,a=t.Utils.toFixed,o={canvas:document.createElement("canvas"),uv:new t.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(t){o[t._renderer.type].render.call(t,this.gl,this.program)},render:function(n,r){this._update();var s=this.parent,a=s._matrix&&s._matrix.manual||s._flagMatrix,c=this._matrix.manual||this._flagMatrix;return(a||c)&&(this._renderer.matrix||(this._renderer.matrix=new t.Array(9)),this._matrix.toArray(!0,i),e(i,s._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*s._renderer.scale,a&&(this._flagMatrix=!0)),this._mask&&(n.enable(n.STENCIL_TEST),n.stencilFunc(n.ALWAYS,1,1),n.colorMask(!1,!1,!1,!0),n.stencilOp(n.KEEP,n.KEEP,n.INCR),o[this._mask._renderer.type].render.call(this._mask,n,r,this),n.colorMask(!0,!0,!0,!0),n.stencilFunc(n.NOTEQUAL,0,1),n.stencilOp(n.KEEP,n.KEEP,n.KEEP)),this._flagOpacity=s._flagOpacity||this._flagOpacity,this._renderer.opacity=this._opacity*(s&&s._renderer?s._renderer.opacity:1),_.each(this.children,o.group.renderChild,{gl:n,program:r}),this._mask&&(n.colorMask(!1,!1,!1,!1),n.stencilOp(n.KEEP,n.KEEP,n.DECR),o[this._mask._renderer.type].render.call(this._mask,n,r,this),n.colorMask(!0,!0,!0,!0),n.stencilFunc(n.NOTEQUAL,0,1),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.disable(n.STENCIL_TEST)),this.flagReset()}},polygon:{render:function(n,r,s){if(!this._visible||!this._opacity)return this;var a=this.parent,c=a._matrix.manual||a._flagMatrix,l=this._matrix.manual||this._flagMatrix,h=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||a._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;return this._update(),(c||l)&&(this._renderer.matrix||(this._renderer.matrix=new t.Array(9)),this._matrix.toArray(!0,i),e(i,a._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*a._renderer.scale),h&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new t.Array(12)),this._renderer.opacity=this._opacity*a._renderer.opacity,o.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),o.getTriangles(this._renderer.rect,this._renderer.triangles),o.updateBuffer(n,this,r),o.updateTexture(n,this)),!this._clip||s?(n.bindBuffer(n.ARRAY_BUFFER,this._renderer.textureCoordsBuffer),n.vertexAttribPointer(r.textureCoords,2,n.FLOAT,!1,0,0),n.bindTexture(n.TEXTURE_2D,this._renderer.texture),n.uniformMatrix3fv(r.matrix,!1,this._renderer.matrix),n.bindBuffer(n.ARRAY_BUFFER,this._renderer.buffer),n.vertexAttribPointer(r.position,2,n.FLOAT,!1,0,0),n.drawArrays(n.TRIANGLES,0,6),this.flagReset()):void 0}},getBoundingClientRect:function(t,e,n){var r,i,s=1/0,a=-(1/0),o=1/0,c=-(1/0);t.forEach(function(t){var e,n,r,i,l,h,u=t.x,f=t.y,d=t.controls;o=Math.min(f,o),s=Math.min(u,s),a=Math.max(u,a),c=Math.max(f,c),t.controls&&(l=d.left,h=d.right,l&&h&&(e=t._relative?l.x+u:l.x,n=t._relative?l.y+f:l.y,r=t._relative?h.x+u:h.x,i=t._relative?h.y+f:h.y,e&&n&&r&&i&&(o=Math.min(n,i,o),s=Math.min(e,r,s),a=Math.max(e,r,a),c=Math.max(n,i,c))))}),_.isNumber(e)&&(o-=e,s-=e,a+=e,c+=e),r=a-s,i=c-o,n.top=o,n.left=s,n.right=a,n.bottom=c,n.width=r,n.height=i,n.centroid||(n.centroid={}),n.centroid.x=-s,n.centroid.y=-o},getTriangles:function(t,e){var n=t.top,r=t.left,i=t.right,s=t.bottom;e[0]=r,e[1]=n,e[2]=i,e[3]=n,e[4]=r,e[5]=s,e[6]=r,e[7]=s,e[8]=i,e[9]=n,e[10]=i,e[11]=s},updateCanvas:function(e){var r=e._vertices,i=this.canvas,s=this.ctx,o=e._renderer.scale,c=e._stroke,l=e._linewidth*o,h=e._fill,u=e._renderer.opacity||e._opacity,f=e._cap,d=e._join,p=e._miter,g=e._closed,m=r.length,v=m-1;i.width=Math.max(Math.ceil(e._renderer.rect.width*o),1),i.height=Math.max(Math.ceil(e._renderer.rect.height*o),1);var y=e._renderer.rect.centroid,x=y.x*o,b=y.y*o;s.clearRect(0,0,i.width,i.height),h&&(s.fillStyle=h),c&&(s.strokeStyle=c),l&&(s.lineWidth=l),p&&(s.miterLimit=p),d&&(s.lineJoin=d),f&&(s.lineCap=f),_.isNumber(u)&&(s.globalAlpha=u);var w;s.beginPath(),r.forEach(function(e,i){var c,l,h,u,f,d,p,_,y,A,E,C,k,S;switch(k=a(e.x*o+x),S=a(e.y*o+b),e._command){case t.Commands.close:s.closePath();break;case t.Commands.curve:l=g?n(i-1,m):Math.max(i-1,0),c=g?n(i+1,m):Math.min(i+1,v),h=r[l],u=r[c],y=h.controls&&h.controls.right||h,A=e.controls&&e.controls.left||e,h._relative?(p=a((y.x+h.x)*o+x),_=a((y.y+h.y)*o+b)):(p=a(y.x*o+x),_=a(y.y*o+b)),e._relative?(f=a((A.x+e.x)*o+x),d=a((A.y+e.y)*o+b)):(f=a(A.x*o+x),d=a(A.y*o+b)),s.bezierCurveTo(p,_,f,d,k,S),i>=v&&g&&(u=w,E=e.controls&&e.controls.right||e,C=u.controls&&u.controls.left||u,e._relative?(p=a((E.x+e.x)*o+x),_=a((E.y+e.y)*o+b)):(p=a(E.x*o+x),_=a(E.y*o+b)),u._relative?(f=a((C.x+u.x)*o+x),d=a((C.y+u.y)*o+b)):(f=a(C.x*o+x),d=a(C.y*o+b)),k=a(u.x*o+x),S=a(u.y*o+b),s.bezierCurveTo(p,_,f,d,k,S));break;case t.Commands.line:s.lineTo(k,S);break;case t.Commands.move:w=e,s.moveTo(k,S)}}),g&&s.closePath(),s.fill(),s.stroke()},updateTexture:function(t,e){this.updateCanvas(e),e._renderer.texture&&t.deleteTexture(e._renderer.texture),t.bindBuffer(t.ARRAY_BUFFER,e._renderer.textureCoordsBuffer),e._renderer.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,e._renderer.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),this.canvas.width<=0||this.canvas.height<=0||t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(t,e,n){_.isObject(e._renderer.buffer)&&t.deleteBuffer(e._renderer.buffer),e._renderer.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e._renderer.buffer),t.enableVertexAttribArray(n.position),t.bufferData(t.ARRAY_BUFFER,e._renderer.triangles,t.STATIC_DRAW),_.isObject(e._renderer.textureCoordsBuffer)&&t.deleteBuffer(e._renderer.textureCoordsBuffer),e._renderer.textureCoordsBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e._renderer.textureCoordsBuffer),t.enableVertexAttribArray(n.textureCoords),t.bufferData(t.ARRAY_BUFFER,this.uv,t.STATIC_DRAW)},program:{create:function(e,n){var r,i,s;if(r=e.createProgram(),_.each(n,function(t){e.attachShader(r,t)}),e.linkProgram(r),i=e.getProgramParameter(r,e.LINK_STATUS),!i)throw s=e.getProgramInfoLog(r),e.deleteProgram(r),new t.Utils.Error("unable to link program: "+s);return r}},shaders:{create:function(e,n,r){var i,s,a;if(i=e.createShader(e[r]),e.shaderSource(i,n),e.compileShader(i),s=e.getShaderParameter(i,e.COMPILE_STATUS),!s)throw a=e.getShaderInfoLog(i),e.deleteShader(i),new t.Utils.Error("unable to compile shader "+i+": "+a);return i},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:["attribute vec2 a_position;","attribute vec2 a_textureCoords;","","uniform mat3 u_matrix;","uniform vec2 u_resolution;","","varying vec2 v_textureCoords;","","void main() {","   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;","   vec2 normal = projected / u_resolution;","   vec2 clipspace = (normal * 2.0) - 1.0;","","   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);","   v_textureCoords = a_textureCoords;","}"].join("\n"),fragment:["precision mediump float;","","uniform sampler2D u_image;","varying vec2 v_textureCoords;","","void main() {","  gl_FragColor = texture2D(u_image, v_textureCoords);","}"].join("\n")}};o.ctx=o.canvas.getContext("2d");var c=t[t.Types.webgl]=function(e){var n,i,s,a;if(this.domElement=e.domElement||document.createElement("canvas"),this.scene=new t.Group,this.scene.parent=this,this._renderer={matrix:new t.Array(r),scale:1,opacity:1},this._flagMatrix=!0,n=_.defaults(e||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=n.overdraw,i=this.ctx=this.domElement.getContext("webgl",n)||this.domElement.getContext("experimental-webgl",n),!this.ctx)throw new t.Utils.Error("unable to create a webgl context. Try using another renderer.");s=o.shaders.create(i,o.shaders.vertex,o.shaders.types.vertex),a=o.shaders.create(i,o.shaders.fragment,o.shaders.types.fragment),this.program=o.program.create(i,[s,a]),i.useProgram(this.program),this.program.position=i.getAttribLocation(this.program,"a_position"),this.program.matrix=i.getUniformLocation(this.program,"u_matrix"),this.program.textureCoords=i.getAttribLocation(this.program,"a_textureCoords"),i.disable(i.DEPTH_TEST),i.enable(i.BLEND),i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA)};_.extend(c.prototype,Backbone.Events,{setSize:function(t,e,n){this.width=t,this.height=e,this.ratio=_.isUndefined(n)?s(this.ctx):n,this.domElement.width=t*this.ratio,this.domElement.height=e*this.ratio,_.extend(this.domElement.style,{width:t+"px",height:e+"px"}),t*=this.ratio,e*=this.ratio,this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,this.ctx.viewport(0,0,t,e);var r=this.ctx.getUniformLocation(this.program,"u_resolution");return this.ctx.uniform2f(r,t,e),this},render:function(){var t=this.ctx;return this.overdraw||t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),o.group.render.call(this.scene,t,this.program),this._flagMatrix=!1,this}})}(Two),function(t){var e=t.Shape=function(){this._renderer={},this.id=t.Identifier+t.uniqueId(),this.classList=[],this._matrix=new t.Matrix,this.translation=new t.Vector,this.translation.bind(t.Events.change,_.bind(e.FlagMatrix,this)),this.rotation=0,this.scale=1};_.extend(e,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(t){Object.defineProperty(t,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t,this._flagMatrix=!0}}),Object.defineProperty(t,"scale",{get:function(){return this._scale},set:function(t){this._scale=t,this._flagMatrix=!0,this._flagScale=!0}})}}),_.extend(e.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(t){return t.add(this),this},clone:function(){var t=new e;return t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,_.each(e.Properties,function(e){t[e]=this[e]},this),t._update()},replaceParent:function(t){var e,n=this.id;return this.parent&&(delete this.parent.children[n],e=_.indexOf(parent.additions,n),e>=0&&this.parent.additions.splice(e,1),this.parent.subtractions.push(n),this._flagSubtractions=!0),t?(t.children[n]=this,this.parent=t,t.additions.push(n),t._flagAdditions=!0):delete this.parent,this},_update:function(t){return!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation),t&&this.parent&&this.parent._update&&this.parent._update(),this},flagReset:function(){return this._flagMatrix=this._flagScale=!1,this}}),e.MakeObservable(e.prototype)}(Two),function(t){function e(e,n,r){var i,s,a,o,c,l,h,u,f=n.controls&&n.controls.right,d=e.controls&&e.controls.left;return i=n.x,c=n.y,s=(f||n).x,l=(f||n).y,a=(d||e).x,h=(d||e).y,o=e.x,u=e.y,f&&n._relative&&(s+=n.x,l+=n.y),d&&e._relative&&(a+=e.x,h+=e.y),t.Utils.getCurveLength(i,c,s,l,a,h,o,u,r)}function n(e,n,r){var i,s,a,o,c,l,h,u,f=n.controls&&n.controls.right,d=e.controls&&e.controls.left;return i=n.x,c=n.y,s=(f||n).x,l=(f||n).y,a=(d||e).x,h=(d||e).y,o=e.x,u=e.y,f&&n._relative&&(s+=n.x,l+=n.y),d&&e._relative&&(a+=e.x,h+=e.y),t.Utils.subdivide(i,c,s,l,a,h,o,u,r)}var r=Math.min,i=Math.max,s=Math.round,a=t.Utils.getComputedMatrix,o={};_.each(t.Commands,function(t,e){o[e]=new RegExp(t)});var c=t.Polygon=function(e,n,r,i){t.Shape.call(this),this._renderer.type="polygon",this._closed=!!n,this._curved=!!r,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this._vertices=[],this.vertices=e,this.automatic=!i};_.extend(c,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"],FlagVertices:function(){this._flagVertices=!0,this._flagLength=!0},MakeObservable:function(e){t.Shape.MakeObservable(e),_.each(c.Properties.slice(0,8),function(t){var n="_"+t,r="_flag"+t.charAt(0).toUpperCase()+t.slice(1);Object.defineProperty(e,t,{get:function(){return this[n]},set:function(t){this[n]=t,this[r]=!0}})}),Object.defineProperty(e,"length",{get:function(){return this._flagLength&&this._updateLength(),this._length}}),Object.defineProperty(e,"closed",{get:function(){return this._closed},set:function(t){this._closed=!!t,this._flagVertices=!0}}),Object.defineProperty(e,"curved",{get:function(){return this._curved},set:function(t){this._curved=!!t,this._flagVertices=!0}}),Object.defineProperty(e,"automatic",{get:function(){return this._automatic;
},set:function(t){if(t!==this._automatic){this._automatic=!!t;var e=this._automatic?"ignore":"listen";_.each(this.vertices,function(t){t[e]()})}}}),Object.defineProperty(e,"beginning",{get:function(){return this._beginning},set:function(t){this._beginning=r(i(t,0),this._ending),this._flagVertices=!0}}),Object.defineProperty(e,"ending",{get:function(){return this._ending},set:function(t){this._ending=r(i(t,this._beginning),1),this._flagVertices=!0}}),Object.defineProperty(e,"vertices",{get:function(){return this._collection},set:function(e){var n=_.bind(c.FlagVertices,this),r=_.bind(function(e){for(var r=e.length;r--;)e[r].bind(t.Events.change,n);n()},this),i=_.bind(function(e){_.each(e,function(e){e.unbind(t.Events.change,n)},this),n()},this);this._collection&&this._collection.unbind(),this._collection=new t.Utils.Collection(e.slice(0)),this._collection.bind(t.Events.insert,r),this._collection.bind(t.Events.remove,i),r(this._collection)}}),Object.defineProperty(e,"clip",{get:function(){return this._clip},set:function(t){this._clip=t,this._flagClip=!0}})}}),_.extend(c.prototype,t.Shape.prototype,{_flagVertices:!0,_flagLength:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_flagClip:!1,_length:0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,_clip:!1,clone:function(e){e=e||this.parent;var n=_.map(this.vertices,function(t){return t.clone()}),r=new c(n,this.closed,this.curved,!this.automatic);return _.each(t.Shape.Properties,function(t){r[t]=this[t]},this),r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,e.add(r),r},toObject:function(){var e={vertices:_.map(this.vertices,function(t){return t.toObject()})};return _.each(t.Shape.Properties,function(t){e[t]=this[t]},this),e.translation=this.translation.toObject,e.rotation=this.rotation,e.scale=this.scale,e},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke="transparent",this},corner:function(){var t=this.getBoundingClientRect(!0);return t.centroid={x:t.left+t.width/2,y:t.top+t.height/2},_.each(this.vertices,function(e){e.addSelf(t.centroid)}),this},center:function(){var t=this.getBoundingClientRect(!0);return t.centroid={x:t.left+t.width/2,y:t.top+t.height/2},_.each(this.vertices,function(e){e.subSelf(t.centroid)}),this},remove:function(){return this.parent?(this.parent.remove(this),this):this},getBoundingClientRect:function(t){this._update(!0);var e,n,s=t?this._matrix:a(this),o=this.linewidth/2,c=1/0,l=-(1/0),h=1/0,u=-(1/0);return _.each(this._vertices,function(t){e=t.x,n=t.y,t=s.multiply(e,n,1),h=r(t.y-o,h),c=r(t.x-o,c),l=i(t.x+o,l),u=i(t.y+o,u)}),{top:h,left:c,right:l,bottom:u,width:l-c,height:u-h}},getPointAt:function(e,n){for(var r,i,s,a,o,c,l,h,u,f,d,p,g=this.length*Math.min(Math.max(e,0),1),m=this.vertices.length,v=m-1,y=null,x=null,b=0,w=this._lengths.length,A=0;w>b;b++){if(A+this._lengths[b]>g){y=this.vertices[this.closed?t.Utils.mod(b,m):b],x=this.vertices[Math.min(Math.max(b-1,0),v)],g-=A,e=g/this._lengths[b];break}A+=this._lengths[b]}return _.isNull(y)||_.isNull(x)?null:(p=x.controls&&x.controls.right,d=y.controls&&y.controls.left,i=x.x,l=x.y,s=(p||x).x,h=(p||x).y,a=(d||y).x,u=(d||y).y,o=y.x,f=y.y,p&&x._relative&&(s+=x.x,h+=x.y),d&&y._relative&&(a+=y.x,u+=y.y),r=t.Utils.getPointOnCubicBezier(e,i,s,a,o),c=t.Utils.getPointOnCubicBezier(e,l,h,u,f),_.isObject(n)?(n.x=r,n.y=c,n):new t.Vector(r,c))},plot:function(){if(this.curved)return t.Utils.getCurveFromPoints(this._vertices,this.closed),this;for(var e=0;e<this._vertices.length;e++)this._vertices[e]._command=0===e?t.Commands.move:t.Commands.line;return this},subdivide:function(e){this._update();var r=this.vertices.length-1,i=this.vertices[r],s=this._closed||this.vertices[r]._command===t.Commands.close,a=[];return _.each(this.vertices,function(o,c){if(0>=c&&!s)return void(i=o);if(o.command===t.Commands.move)return a.push(new t.Anchor(i.x,i.y)),c>0&&(a[a.length-1].command=t.Commands.line),void(i=o);var l=n(o,i,e);a=a.concat(l),_.each(l,function(e,n){0>=n&&i.command===t.Commands.move?e.command=t.Commands.move:e.command=t.Commands.line}),c>=r&&(this._closed&&this._automatic?(i=o,l=n(o,i,e),a=a.concat(l),_.each(l,function(e,n){0>=n&&i.command===t.Commands.move?e.command=t.Commands.move:e.command=t.Commands.line})):s&&a.push(new t.Anchor(o.x,o.y)),a[a.length-1].command=s?t.Commands.close:t.Commands.line),i=o},this),this._automatic=!1,this._curved=!1,this.vertices=a,this},_updateLength:function(n){this._update();var r=this.vertices.length-1,i=this.vertices[r],s=this._closed||this.vertices[r]._command===t.Commands.close,a=0;return _.isUndefined(this._lengths)&&(this._lengths=[]),_.each(this.vertices,function(o,c){return 0>=c&&!s||o.command===t.Commands.move?(i=o,void(this._lengths[c]=0)):(this._lengths[c]=e(o,i,n),a+=this._lengths[c],c>=r&&s&&(i=o,this._lengths[c+1]=e(o,i,n),a+=this._lengths[c+1]),void(i=o))},this),this._length=a,this},_update:function(){if(this._flagVertices){var e,n=this.vertices.length,r=n-1,i=s(this._beginning*r),a=s(this._ending*r);this._vertices.length=0;for(var o=i;a+1>o;o++)e=this.vertices[o],this._vertices.push(e);this._automatic&&this.plot()}return t.Shape.prototype._update.call(this),this},flagReset:function(){return this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=!1,t.Shape.prototype.flagReset.call(this),this}}),c.MakeObservable(c.prototype)}(Two),function(t){var e=Math.min,n=Math.max,r=t.Group=function(){t.Shape.call(this,!0),this._renderer.type="group",this.additions=[],this.subtractions=[],this.children={}};_.extend(r,{MakeObservable:function(e){var n=t.Polygon.Properties.slice(0),i=_.indexOf(n,"opacity");i>=0&&(n.splice(i,1),Object.defineProperty(e,"opacity",{get:function(){return this._opacity},set:function(t){this._opacity=t,this._flagOpacity=!0}})),t.Shape.MakeObservable(e),r.MakeGetterSetters(e,n),Object.defineProperty(e,"mask",{get:function(){return this._mask},set:function(t){this._mask=t,this._flagMask=!0,t.clip||(t.clip=!0)}})},MakeGetterSetters:function(t,e){_.isArray(e)||(e=[e]),_.each(e,function(e){r.MakeGetterSetter(t,e)})},MakeGetterSetter:function(t,e){var n="_"+e;Object.defineProperty(t,e,{get:function(){return this[n]},set:function(t){this[n]=t,_.each(this.children,function(n){n[e]=t})}})}}),_.extend(r.prototype,t.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_flagOpacity:!0,_flagMask:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,_mask:null,clone:function(t){t=t||this.parent;var e=new r;t.add(e);_.map(this.children,function(t){return t.clone(e)});return e.translation.copy(this.translation),e.rotation=this.rotation,e.scale=this.scale,e},toObject:function(){var t={children:{},translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};return _.each(this.children,function(e,n){t.children[n]=e.toObject()},this),t},corner:function(){var t=this.getBoundingClientRect(!0),e={x:t.left,y:t.top};return _.each(this.children,function(t){t.translation.subSelf(e)}),this},center:function(){var t=this.getBoundingClientRect(!0);return t.centroid={x:t.left+t.width/2,y:t.top+t.height/2},_.each(this.children,function(e){e.translation.subSelf(t.centroid)}),this},getById:function(t){var e=function(t,n){if(t.id===n)return t;for(var r in t.children){var i=e(t.children[r],n);if(i)return i}};return e(this,t)||null},getByClassName:function(t){var e=[],n=function(t,r){-1!=t.classList.indexOf(r)&&e.push(t);for(var i in t.children)n(t.children[i],r);return e};return n(this,t)},getByType:function(e){var n=[],r=function(e,i){for(var s in e.children)e.children[s]instanceof i?n.push(e.children[s]):e.children[s]instanceof t.Group&&r(e.children[s],i);return n};return r(this,e)},add:function(t){var e,n,r,i=(arguments.length,this.children),s=(this.parent,this.additions);return _.isArray(t)||(t=_.toArray(arguments)),_.each(t,function(t){t&&(e=t.id,n=t.parent,_.isUndefined(i[e])&&(n&&(delete n.children[e],r=_.indexOf(n.additions,e),r>=0&&n.additions.splice(r,1)),i[e]=t,t.parent=this,s.push(e),this._flagAdditions=!0))},this),this},remove:function(t){var e,n,r,i,s=arguments.length,a=this.children,o=this.parent,c=this.subtractions;return 0>=s&&o?(o.remove(this),this):(_.isArray(t)||(t=_.toArray(arguments)),_.each(t,function(t){e=t.id,i=t.children,n=t.parent,e in a&&(delete a[e],delete t.parent,r=_.indexOf(n.additions,e),r>=0&&n.additions.splice(r,1),c.push(e),this._flagSubtractions=!0)},this),this)},getBoundingClientRect:function(){var t;this._update(!0);var r=1/0,i=-(1/0),s=1/0,a=-(1/0);return _.each(this.children,function(o){t=o.getBoundingClientRect(),_.isNumber(t.top)&&_.isNumber(t.left)&&_.isNumber(t.right)&&_.isNumber(t.bottom)&&(s=e(t.top,s),r=e(t.left,r),i=n(t.right,i),a=n(t.bottom,a))},this),{top:s,left:r,right:i,bottom:a,width:i-r,height:a-s}},noFill:function(){return _.each(this.children,function(t){t.noFill()}),this},noStroke:function(){return _.each(this.children,function(t){t.noStroke()}),this},subdivide:function(){var t=arguments;return _.each(this.children,function(e){e.subdivide.apply(e,t)}),this},flagReset:function(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),this._flagMask=this._flagOpacity=!1,t.Shape.prototype.flagReset.call(this),this}}),r.MakeObservable(r.prototype)}(Two);
angular.module("pb.faceController",[]).controller("faceController",["$scope","$timeout",function(e,o){var l={width:500,height:400,autostart:!0},r=new Two(l).appendTo(document.querySelector("#face")),t=r.makeCircle(50,100,20),a=r.makeCircle(210,100,20),i=r.makeCircle(130,150,50),n=r.makeCircle(130,230,20),c=r.makeCircle(125,205,200);t.fill="brown",t.stroke="orangered",t.linewidth=5,a.fill="brown",a.stroke="orangered",a.linewidth=5,i.fill="gold",i.noStroke(),n.fill="orangered",n.stroke="tomato",n.linewidth=5,c.fill="gold",c.opacity=.35,c.noStroke();var d=r.makeGroup(c,a,t,i,n);d.translation.set(r.width/2,r.height/2),d.scale=.65,r.bind("update",function(){n.scale>.8&&(n.scale=.5),n.scale+=.02})}]);
angular.module("pb.services",[]).service("MathService",function(){this.add=function(i,t){return i+t},this.subtract=function(i,t){return i-t},this.multiply=function(i,t){return i*t},this.divide=function(i,t){return i/t}}).service("CalculatorService",["MathService",function(i){this.square=function(t){return i.multiply(t,t)},this.cube=function(t){return i.multiply(t,i.multiply(t,t))}}]).service("ValidateService",function(){this.isValidate=function(i,t){var e=!0;return""==i||null==i||void 0==i?e=!1:(i=i.toLocaleLowerCase(),angular.forEach(t,function(t){i==t&&(e=!1)},i),e)}}).service("TagService",["ValidateService",function(i){var t={cities:["野々市","金沢","東京","大阪","名古屋"]};this.get=function(){return t},this.add=function(e,n){i.isValidate(e,t.cities)?(t.cities.push(e),n(!0)):n(!1)},this.del=function(i,e){t.cities.splice(i,1),e(!0)}}]);
angular.module("pb.searchController",[]).controller("searchController",["$scope","$http","$filter",function(e,t,r){e.pageName="iTunes Music Search",e.search=function(t){if("string"==typeof e.searchText){var r=e.searchText;e.getJsonp(r)}},e.getJsonp=function(r){t.jsonp("http://itunes.apple.com/search",{params:{callback:"JSON_CALLBACK",term:r,entity:"album"}}).success(function(t){e.items=t.results}).error(function(e){console.log(e)})}}]);
angular.module("pb.snippetController",[]).controller("snippetController",["$scope",function(e){e.pageName="Public Code Snippets"}]);var SnippetBox=React.createClass({displayName:"SnippetBox",getFromServer:function(){$.ajax({url:"https://api.mongolab.com/api/1/databases/portfolio/collections/p_snippets/?apiKey=aBA-P5F3Ke6OWmt7soYMelXjbkxs1vIO",dataType:"json",success:function(e){this.setState({data:e})}.bind(this),error:function(e,t,a){console.log(this.props.url,t,a.toString())}.bind(this)})},doSubmit:function(e){$.ajax({url:"https://api.mongolab.com/api/1/databases/portfolio/collections/p_snippets/?apiKey=aBA-P5F3Ke6OWmt7soYMelXjbkxs1vIO",contentType:"application/json",type:"POST",data:JSON.stringify(e),success:function(e){this.setState({data:e})}.bind(this),error:function(e,t,a){console.error(this.props.url,t,a.toString())}.bind(this)})},getInitialState:function(){return{data:[]}},componentDidMount:function(){this.getFromServer(),setInterval(this.getFromServer,1e3)},render:function(){return React.createElement("div",{className:"snippet-box"},React.createElement(SnippetList,{data:this.state.data}),React.createElement(SnippetForm,{onSnippetSubmit:this.doSubmit}))}}),SnippetList=React.createClass({displayName:"SnippetList",render:function(){var e=this.props.data.map(function(e){return React.createElement(Snippet,{language:e.language,title:e.title,timestamp:e.timestamp},e.text)});return React.createElement("div",{className:"snippet-list"},e)}}),Snippet=React.createClass({displayName:"Snippet",render:function(){var e="devicon-"+this.props.language+"-plain colored";marked.setOptions({highlight:function(e){return hljs.highlightAuto(e).value}});var t=marked(this.props.children.toString(),{sanitize:!0});return React.createElement("div",{className:"snippet"},React.createElement("i",{className:e}),React.createElement("h3",null,this.props.title),React.createElement("div",{className:"md-text jp",dangerouslySetInnerHTML:{__html:t}}),React.createElement("small",null,moment(this.props.timestamp).locale("ja").startOf("hour").fromNow()))}}),SnippetForm=React.createClass({displayName:"SnippetForm",watchSubmit:function(e){e.preventDefault();var t=React.findDOMNode(this.refs.language).value.trim(),a=React.findDOMNode(this.refs.title).value.trim(),i=React.findDOMNode(this.refs.text).value.trim();t&&a&&i&&(this.props.onSnippetSubmit({language:t,title:a,text:i,timestamp:new Date}),React.findDOMNode(this.refs.language).value="",React.findDOMNode(this.refs.title).value="",React.findDOMNode(this.refs.text).value="")},render:function(){return React.createElement("div",{className:"snippet-form"},React.createElement("form",{className:"pure-form pure-form-stacked",onSubmit:this.watchSubmit},React.createElement("input",{className:"pure-input-2-5 jp",type:"text",placeholder:"言語や開発ツール名を入力してください。",ref:"language"}),React.createElement("input",{className:"pure-input-3-5 jp",type:"text",placeholder:"タイトルを入力してください。",ref:"title"}),React.createElement("textarea",{className:"pure-input-2-1",ref:"text"}),React.createElement("input",{className:"pure-button pure-input-1-2 pure-button-primary jp",type:"submit",value:"コードを保存する"})))}});
angular.module("pb.tagController",[]).controller("tagController",["$scope","TagService",function(t,a){t.pageName="Japan City Tag Handler",t.tags=a.get(),t.addTag=function(e){(13==e.keyCode||44==e.which||"click"==e.type)&&a.add(t.inputTag,function(a){t.alert=!0,t.msg=a,t.inputTag="",e.target.blur()})},t.delTag=function(e,n,o,g){"click"==e.type&&(e.stopPropagation(),e.preventDefault(),a.del(n,function(a){t.msg=a}))}}]);